# Story 9.4: Live Tools -- Traceroute

> **Epic:** 9 - Alerts, Firmware & Observability
> **Sprint:** S8
> **Priority:** P0 (core operations)
> **Points:** 3
> **Type:** Backend/Python
> **Agent:** @dev
> **Depends on:** None (independent)

---

## Status

**Draft**

---

## Story

**As a** network engineer,
**I want** to run traceroute from Meraki devices,
**so that** I can diagnose routing and path issues.

---

## Acceptance Criteria

1. `create_traceroute` initiates a traceroute from a device
2. `get_traceroute_result` polls for results with hop-by-hop data
3. Results include hop IP, hostname (if resolvable), and latency
4. Natural language: "traceroute to 10.0.0.1 from AP-lobby" works

---

## Scope

| Layer | New Items | Details |
|-------|-----------|---------|
| `api.py` | 2 methods | `create_traceroute`, `get_traceroute_result` |
| `agent_tools.py` | 2 schemas | network-analyst tools |
| Safety | SAFE | Read-only diagnostic |

---

## Implementation Pattern

This story follows a simplified implementation pattern (no discovery or config functions):
1. `api.py` — Add SDK wrapper methods with `@log_api_call` (async polling pattern)
2. `agent_router.py` — Register in `FUNCTION_REGISTRY`
3. `agent_tools.py` — Add tool schemas + TOOL_SAFETY classification
4. `safety.py` — Register in `SAFETY_CLASSIFICATION`
5. `tests/` — Add comprehensive tests

**Note:** Both `SAFETY_CLASSIFICATION` (safety.py) and `TOOL_SAFETY` (agent_tools.py) must be updated. No discovery.py or config.py changes needed for this story.

---

## Tasks

- [ ] Add api.py methods (`create_traceroute`, `get_traceroute_result`) with async polling and retry
- [ ] Register in FUNCTION_REGISTRY (agent_router.py)
- [ ] Add tool schemas to agent_tools.py (2 schemas for network-analyst)
- [ ] Register safety classifications in safety.py and agent_tools.py (SAFE)
- [ ] Add tests (target: >= 90% coverage)
- [ ] Verify all schemas pass validate_tool_schema()

---

## File List

(To be populated during implementation)

---
